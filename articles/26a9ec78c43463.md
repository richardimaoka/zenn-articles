---
title: "ã‚³ãƒ”ãƒšã§å­¦ã¶ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«: ã‚µãƒ¼ãƒãƒ¼å¾…ã¡ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’Apollo Client + Reactã§è¡Œã†"
emoji: "ğŸ·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢h" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["GraphQL"]
published: false
---

## å°å…¥

Apollo Client ã§æ§‹ç¯‰ã—ãŸ GraphQL ã‚µãƒ¼ãƒãƒ¼ã¨é€šä¿¡ã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”å¾…ã¡ã®é–“ã«ã€ã„ã‚ã‚†ã‚‹ã€Œã‚¹ãƒ”ãƒŠãƒ¼ã€ãªã©ã‚’è¦‹ã›ã‚‹ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’è¡Œã„ãŸã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

![spinner](/images/26a9ec78c43463/Spinner.gif)

ãã“ã§æœ¬è¨˜äº‹ã§ã¯ Apollo Client ã® API ã«æ²¿ã£ãŸå½¢ã§ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’ React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚æ‰‹ã‚’å‹•ã‹ã—ã¦å‹•ä½œç¢ºèªã§ãã‚‹ã¨ç†è§£ãŒã—ã‚„ã™ã„ã‹ã¨æ€ã„ã€ã‚³ãƒ”ãƒšã ã‘ã§ç°¡å˜ã«å­¦ã¹ã‚‹ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã«ã—ã¦ã„ã¾ã™ã€‚

:::details React Suspense ã¯ä½¿ã‚ãªã„ã®ï¼Ÿ
https://github.com/apollographql/apollo-client/issues/9627
:::

![placeholder](/images/26a9ec78c43463/placeholder.png)

## äº‹å‰æº–å‚™ - ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

ã¾ãšã¯æœ¬ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

```sh:ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
mkdir tutorial-apollo-client-loading
cd tutorial-apollo-client-loading
```

æœ€çµ‚çš„ãªå…¨ä½“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```:ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
tutorial-apollo-client-loading
  |- server     # GraphQL Server
  |- client     # React Client
```

ãã‚Œã§ã¯æ¬¡ã®æ‰‹é †ã§ã€ä¸Šè¨˜ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã®ã†ã¡ã€`server`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ä½œæˆã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

## äº‹å‰æº–å‚™ - GraphQL ã‚µãƒ¼ãƒãƒ¼

ã¾ãšã¯ GraphQL ã‚µãƒ¼ãƒãƒ¼ã‚’æº–å‚™ã—ã¾ã™ã€‚

```sh:ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
# ä¸€åº¦ã«å…¨éƒ¨ã‚³ãƒ”ãƒšã§å®Ÿè¡Œã§ãã¾ã™

mkdir server
cd server

# node.js setup
npm init -y
echo "node_modules" > .gitignore

# install and initialize typescript
npm install --save-dev typescript
npx tsc --init

# ts-node-dev: watch and restart a TypeScript server
npm install --save-dev ts-node-dev
npm pkg set scripts.start="ts-node-dev --watch src/* --respawn src/index.ts"

# apollo server
npm install apollo-server graphql

# install and setup graphql-codegen
npm install --save-dev @graphql-codegen/cli
# ã“ã“ã§ npx graphql-code-generator init ã‚’è¡Œã£ã¦ã‚‚ã‚ˆã„ãŒã€ãã†ã™ã‚‹ã¨å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã£ã¦æ‰‹å…¥åŠ›ãŒå¢—ãˆã‚‹ã®ã¨ã€
# çµå±€ã¯ npx graphql-code-generator init ã§ç”Ÿæˆã•ã‚ŒãŸconfig.ymlã‚’ä¸Šæ›¸ãæ›´æ–°ã™ã‚‹ã“ã¨ã«ãªã‚‹ã®ã§ã€ä»¥ä¸‹ã¯npm installã®ã¿è¡Œã£ã¦ config.ymlã¯å¾Œã»ã©ä½œæˆ
npm install --save-dev  @graphql-codegen/typescript @graphql-codegen/typescript-resolvers
npm pkg set scripts.generate="graphql-codegen --config codegen.yml --watch ./schema.gql" # update generate script

# copy files
mkdir src
mkdir data
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/codegen.yml > codegen.yml
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/schema.gql > schema.gql
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/src/index.ts > src/index.ts
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/data/Query.json > data/Query.json

# tutorial-apollo-client-loading ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æˆ»ã‚‹
cd ../
```

## äº‹å‰æº–å‚™ - React ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

```sh:ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
# ä¸€åº¦ã«å…¨éƒ¨ã‚³ãƒ”ãƒšã§å®Ÿè¡Œã§ãã¾ã™

mkdir server
cd server

# node.js setup
npm init -y
echo "node_modules" > .gitignore

# install and initialize typescript
npm install --save-dev typescript
npx tsc --init

# ts-node-dev: watch and restart a TypeScript server
npm install --save-dev ts-node-dev
npm pkg set scripts.start="ts-node-dev --watch src/* --respawn src/index.ts"

# apollo server
npm install apollo-server graphql

# install and setup graphql-codegen
npm install --save-dev @graphql-codegen/cli
# ã“ã“ã§ npx graphql-code-generator init ã‚’è¡Œã£ã¦ã‚‚ã‚ˆã„ãŒã€ãã†ã™ã‚‹ã¨å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã£ã¦æ‰‹å…¥åŠ›ãŒå¢—ãˆã‚‹ã®ã¨ã€
# çµå±€ã¯ npx graphql-code-generator init ã§ç”Ÿæˆã•ã‚ŒãŸconfig.ymlã‚’ä¸Šæ›¸ãæ›´æ–°ã™ã‚‹ã“ã¨ã«ãªã‚‹ã®ã§ã€ä»¥ä¸‹ã¯npm installã®ã¿è¡Œã£ã¦ config.ymlã¯å¾Œã»ã©ä½œæˆ
npm install --save-dev  @graphql-codegen/typescript @graphql-codegen/typescript-resolvers
npm pkg set scripts.generate="graphql-codegen --config codegen.yml --watch ./schema.gql" # update generate script

# copy files
mkdir src
mkdir data
curl https://raw.githubusercontent.com/richardimaoka/tutorial-react-graphql-setup/a61745c7a63580df65a911734f423f673c390261/server/codegen.yml > codegen.yml
curl https://raw.githubusercontent.com/richardimaoka/tutorial-react-graphql-setup/a61745c7a63580df65a911734f423f673c390261/server/schema.gql > schema.gql
curl https://raw.githubusercontent.com/richardimaoka/tutorial-react-graphql-setup/a61745c7a63580df65a911734f423f673c390261/server/src/index.ts > src/index.ts
curl https://raw.githubusercontent.com/richardimaoka/tutorial-react-graphql-setup/a61745c7a63580df65a911734f423f673c390261/server/data/Query.json > data/Query.json

# tutorial-apollo-client-loading ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æˆ»ã‚‹
cd ../
```

ç¶šã„ã¦ã€å¾Œã»ã© Spinner ã‚’è¡¨ç¤ºã™ã‚‹ã®ã«åˆ©ç”¨ã™ã‚‹ FontAwesome ã‚‚å°å…¥ã—ã¾ã—ã‚‡ã†ã€‚[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã® React ç”¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †](https://fontawesome.com/docs/web/use-with/react/)ã«å¾“ã£ã¦ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```sh:ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
# Add SVG Core
npm i --save @fortawesome/fontawesome-svg-core

# Add Icon Packages
npm i --save @fortawesome/free-solid-svg-icons
npm i --save @fortawesome/free-regular-svg-icons

# Add the React Component
npm i --save @fortawesome/react-fontawesome@latest
```

## äº‹å‰æº–å‚™ - ãƒ—ãƒ­ã‚»ã‚¹ç«‹ã¡ä¸Šã’

![terminals](/images/26a9ec78c43463/terminals.png)
