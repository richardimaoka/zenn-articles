---
title: "ã‚³ãƒ”ãƒšã§å­¦ã¶ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«: ã‚µãƒ¼ãƒãƒ¼å¾…ã¡ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’Apollo Client + Reactã§è¡Œã†"
emoji: "ğŸ·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢h" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["GraphQL"]
published: false
---

## å°å…¥

Apollo Client ã§æ§‹ç¯‰ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã€ GraphQL ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”å¾…ã¡ã®é–“ã«ã€ã„ã‚ã‚†ã‚‹ã€Œã‚¹ãƒ”ãƒŠãƒ¼ã€ãªã©ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’è¡Œã„ãŸã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

![spinner](/images/26a9ec78c43463/Spinner.gif)

ãã“ã§æœ¬è¨˜äº‹ã§ã¯ Apollo Client ã® API ã«æ²¿ã£ãŸå½¢ã§ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’ React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚æ‰‹ã‚’å‹•ã‹ã—ã¦å‹•ä½œç¢ºèªã§ãã‚‹ã¨ç†è§£ãŒã—ã‚„ã™ã„ã‹ã¨æ€ã„ã€ã‚³ãƒ”ãƒšã ã‘ã§ç°¡å˜ã«å­¦ã¹ã‚‹ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã«ã—ã¦ã„ã¾ã™ã€‚

:::details React Suspense ã¯ä½¿ã‚ãªã„ã®ï¼Ÿ
ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’è¡Œã„ãŸã„å ´åˆã€React 18 ä»¥é™ã§ã¯[Suspense](https://reactjs.org/blog/2022/03/29/react-v18.html#suspense-in-data-frameworks)ãŒé¸æŠè‚¢ã«ä¸ŠãŒã‚‹ã§ã—ã‚‡ã†ã€‚ã¨ã“ã‚ãŒã€[GitHub: apollo-client - Adding React suspense + data fetching support](https://github.com/apollographql/apollo-client/issues/9627)ã«ã‚ã‚‹ã‚ˆã†ã«ã€Apollo Client å…¬å¼ã§ã¯ã¾ã  Suspense ã¨ã®çµ±åˆæ–¹æ³•ã‚’ç´¹ä»‹ã—ã¦ã„ã¾ã›ã‚“ã€‚

Apollo Client å…¬å¼ãŒæ¨å¥¨ã™ã‚‹æ–¹æ³•ãŒæ±ºã¾ã‚‹ã¾ã§ã¯ã€æœ¬è¨˜äº‹ã®ã‚ˆã†ã« Suspense ã‚’ä½¿ã‚ãªã„å¾“æ¥ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºãŒå‚è€ƒã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚
:::

## äº‹å‰æº–å‚™

ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ä½œæˆã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã®æ§‹æˆã¯ã“ã¡ã‚‰ã§ã™ã€‚

![placeholder](/images/26a9ec78c43463/placeholder.png)

ã“ã¡ã‚‰ã®æ§‹æˆã‚’ä½œã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

### äº‹å‰æº–å‚™ 1. ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

ã¾ãšã¯æœ¬ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

```sh:ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
mkdir tutorial-apollo-client-loadinã€‚
cd tutorial-apollo-client-loading
```

å…¨ä½“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯æœ€çµ‚çš„ã«ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```:ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
tutorial-apollo-client-loading
  +- server  # GraphQL Server
  +- client  # React Client
```

ãã‚Œã§ã¯æ¬¡ã®æ‰‹é †ã§ã€ä¸Šè¨˜ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã®ã†ã¡ã€`server`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ä½œæˆã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

### äº‹å‰æº–å‚™ 2. GraphQL ã‚µãƒ¼ãƒãƒ¼

ã¾ãšã¯ GraphQL ã‚µãƒ¼ãƒãƒ¼ã‚’æº–å‚™ã—ã¾ã™ã€‚

```sh:ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
# ä¸€åº¦ã«å…¨éƒ¨ã‚³ãƒ”ãƒšã§å®Ÿè¡Œã§ãã¾ã™

mkdir server
cd server

# node.js setup
npm init -y
echo "node_modules" > .gitignore

# install and initialize typescript
npm install --save-dev typescript
npx tsc --init

# ts-node-dev: watch and restart a TypeScript server
npm install --save-dev ts-node-dev
npm pkg set scripts.start="ts-node-dev --watch src/* --respawn src/index.ts"

# apollo server
npm install apollo-server graphql

# install and setup graphql-codegen
npm install --save-dev @graphql-codegen/cli
# ã“ã“ã§ npx graphql-code-generator init ã‚’è¡Œã£ã¦ã‚‚ã‚ˆã„ãŒã€ãã†ã™ã‚‹ã¨å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã£ã¦æ‰‹å…¥åŠ›ãŒå¢—ãˆã‚‹ã®ã¨ã€
# çµå±€ã¯ npx graphql-code-generator init ã§ç”Ÿæˆã•ã‚ŒãŸconfig.ymlã‚’ä¸Šæ›¸ãæ›´æ–°ã™ã‚‹ã“ã¨ã«ãªã‚‹ã®ã§ã€ä»¥ä¸‹ã¯npm installã®ã¿è¡Œã£ã¦ config.ymlã¯å¾Œã»ã©ä½œæˆ
npm install --save-dev  @graphql-codegen/typescript @graphql-codegen/typescript-resolvers
npm pkg set scripts.generate="graphql-codegen --config codegen.yml --watch ./schema.gql" # update generate script

# copy files
mkdir src
mkdir data
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/codegen.yml > codegen.yml
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/schema.gql > schema.gql
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/src/index.ts > src/index.ts
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/data/Query.json > data/Query.json

# tutorial-apollo-client-loading ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æˆ»ã‚‹
cd ../
```

### äº‹å‰æº–å‚™ 3. React ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

```sh:ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
# ä¸€åº¦ã«å…¨éƒ¨ã‚³ãƒ”ãƒšã§å®Ÿè¡Œã§ãã¾ã™

mkdir server
cd server

# node.js setup
npm init -y
echo "node_modules" > .gitignore

# install and initialize typescript
npm install --save-dev typescript
npx tsc --init

# ts-node-dev: watch and restart a TypeScript server
npm install --save-dev ts-node-dev
npm pkg set scripts.start="ts-node-dev --watch src/* --respawn src/index.ts"

# apollo server
npm install apollo-server graphql

# install and setup graphql-codegen
npm install --save-dev @graphql-codegen/cli
# ã“ã“ã§ npx graphql-code-generator init ã‚’è¡Œã£ã¦ã‚‚ã‚ˆã„ãŒã€ãã†ã™ã‚‹ã¨å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã£ã¦æ‰‹å…¥åŠ›ãŒå¢—ãˆã‚‹ã®ã¨ã€
# çµå±€ã¯ npx graphql-code-generator init ã§ç”Ÿæˆã•ã‚ŒãŸconfig.ymlã‚’ä¸Šæ›¸ãæ›´æ–°ã™ã‚‹ã“ã¨ã«ãªã‚‹ã®ã§ã€ä»¥ä¸‹ã¯npm installã®ã¿è¡Œã£ã¦ config.ymlã¯å¾Œã»ã©ä½œæˆ
npm install --save-dev  @graphql-codegen/typescript @graphql-codegen/typescript-resolvers
npm pkg set scripts.generate="graphql-codegen --config codegen.yml --watch ./schema.gql" # update generate script

# copy files
mkdir src
mkdir data
curl https://raw.githubusercontent.com/richardimaoka/tutorial-react-graphql-setup/a61745c7a63580df65a911734f423f673c390261/server/codegen.yml > codegen.yml
curl https://raw.githubusercontent.com/richardimaoka/tutorial-react-graphql-setup/a61745c7a63580df65a911734f423f673c390261/server/schema.gql > schema.gql
curl https://raw.githubusercontent.com/richardimaoka/tutorial-react-graphql-setup/a61745c7a63580df65a911734f423f673c390261/server/src/index.ts > src/index.ts
curl https://raw.githubusercontent.com/richardimaoka/tutorial-react-graphql-setup/a61745c7a63580df65a911734f423f673c390261/server/data/Query.json > data/Query.json

# tutorial-apollo-client-loading ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æˆ»ã‚‹
cd ../
```

#### Font-awesome ã®å°å…¥

ç¶šã„ã¦ã€å¾Œã»ã©ã‚¹ãƒ”ãƒŠãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ã®ã«åˆ©ç”¨ã™ã‚‹ FontAwesome ã‚‚å°å…¥ã—ã¾ã—ã‚‡ã†ã€‚[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã® React ç”¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †](https://fontawesome.com/docs/web/use-with/react/)ã«å¾“ã£ã¦ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```sh:ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
# Add SVG Core
npm i --save @fortawesome/fontawesome-svg-core

# Add Icon Packages
npm i --save @fortawesome/free-solid-svg-icons
npm i --save @fortawesome/free-regular-svg-icons

# Add the React Component
npm i --save @fortawesome/react-fontawesome@latest
```

## ãƒ—ãƒ­ã‚»ã‚¹ç«‹ã¡ä¸Šã’

4 ã¤ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç«‹ã¡ä¸Šã’ã¾ã™

![terminals](/images/26a9ec78c43463/terminals.png)

## é…å»¶ã®ãªã„å ´åˆã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’ä½œã‚‹å‰ã«ã€é…å»¶ã®ãªã„å ´åˆã®ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã‚’è¡Œã„ã¾ã—ã‚‡ã†ã€‚ã”ãç°¡å˜ãªäººç‰©ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’ 3 äººåˆ†è¡¨ç¤ºã—ã¦ã¿ã¾ã™ã€‚

![faces](/images/26a9ec78c43463/faces.png)

```sh:
command...
```

## é…å»¶ãŒã‚ã‚‹å ´åˆã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º

ã„ã‚ˆã„ã‚ˆãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã§ã™ã€‚

### ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã«é…å»¶ã‚’æŒ¿å…¥

```sh:
command...
```

```ts:
diff
```

![placeholder](/images/26a9ec78c43463/placeholder.png)

### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’å°å…¥

```sh:
command...
```

```ts:
diff
```

![spinner](/images/26a9ec78c43463/Spinner.gif)
