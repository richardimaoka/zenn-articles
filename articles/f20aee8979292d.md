---
title: "ã‚³ãƒ”ãƒšã§å­¦ã¶ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«: GitHub Pull Request 3ç¨®é¡ã®mergeæ‰‹æ³•ã‚’è©¦ã™"
emoji: "ğŸ·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["git"]
published: false
---

## å°å…¥

GitHub ã® Pull Request ã‚’ãƒãƒ¼ã‚¸ã™ã‚‹æ–¹æ³•ã«ã¯ 3 ç¨®é¡ã®æ–¹æ³•ã€Merge pull request(Create a merge commit)ã€Squash and mergeã€Rebase and merge ãŒã‚ã‚Šã¾ã™ã€‚

![Create a merge commit](/images/f20aee8979292d/pr-merge-merge-commit.png)

:::details ãã‚Œãã‚Œã®é•ã„ã«ã¤ã„ã¦ã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã‚‚ã€Qiita ãªã©ã§ã‚‚è§£èª¬ã•ã‚Œã¦ã„ã¾ã™ã€‚

- GitHub Docs (å…¬å¼):

  - [ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒãƒ¼ã‚¸ã«ã¤ã„ã¦](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/incorporating-changes-from-a-pull-request/about-pull-request-merges)
  - [ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒãƒ¼ã‚¸ã™ã‚‹](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/incorporating-changes-from-a-pull-request/merging-a-pull-request)

- Qiita:

  - [ Github ã§ã® Web ä¸Šã‹ã‚‰ã®ãƒãƒ¼ã‚¸ã®ä»•æ–¹ 3 ç¨®ã¨ãã®ä½¿ã„ã©ã“ã‚](https://qiita.com/ko-he-8/items/94e872f2154829c868df)

:::

ã™ã§ã«æ§˜ã€…ãªå ´æ‰€ã§è§£èª¬ã•ã‚Œã¦ã„ã‚‹å†…å®¹ã§ã™ãŒã€ã‚ã‚‰ãŸã‚ã¦è‡ªåˆ†ã§æ‰‹ã‚’å‹•ã‹ã—ã¦å‹•ä½œç¢ºèªã™ã‚‹ã¨ã€çŸ¥è­˜ã®æ•´ç†ãŒã§ãã‚‹ã¨æ€ã„ã¾ã™ã€‚

ãã‚Œã§ã¯ã€ã“ã“ã‹ã‚‰ã¯ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚³ãƒ”ãƒšã§è²¼ã‚Šä»˜ã‘ã¦å†ç¾ã§ãã‚‹å½¢ã§ã€å‹•ä½œç¢ºèªã®æ‰‹é †ã‚’èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚

## GitHub ãƒ¬ãƒã‚¸ãƒˆãƒªã®ä½œæˆ

ã¾ãšã¯ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ git ãƒ¬ãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
mkdir pull-req-merge-experiments
cd pull-req-merge-experiments
git init
```

GitHub ä¸Šã«ãƒ¬ãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚Web ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ãªãã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ãˆã°ä¸€ç™ºã§çµ‚ã‚ã‚Šã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
gh repo create "" --public --source=. --remote=origin
```

:::details ã€€ä¸Šè¨˜ã® gh ã‚³ãƒãƒ³ãƒ‰ã¯ä½•ï¼Ÿ
[gh ã‚³ãƒãƒ³ãƒ‰(GitHub CLI)](https://cli.github.com/)ã‚’ä½¿ãˆã°ã€GitHub ä¸Šã§ã®ãƒªãƒã‚¸ãƒˆãƒªä½œæˆãªã©ä½œæ¥­ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰ã‚³ãƒãƒ³ãƒ‰ã²ã¨ã¤ã§è¡Œãˆã¾ã™ã€‚ã¾ã ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãªã„æ–¹ã¯ã€ãœã²ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚[gh repo create ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã®èª¬æ˜ã¯ã“ã¡ã‚‰](https://cli.github.com/manual/gh_repo_create)ã€‚
:::

## Merge pull request(Create a merge commit)

ã¾ãšã¯ 3 ç¨®é¡ã®ãƒãƒ¼ã‚¸æ‰‹æ³•ã®ã†ã¡ã€Merge commit ã‹ã‚‰èª¬æ˜ã—ã¾ã™ã€‚

![Create a merge commit](/images/f20aee8979292d/pr-merge-merge-commit.png)

ã¾ãšã¯æœ€åˆã®ã‚³ãƒŸãƒƒãƒˆã§ç·¨é›†å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ« `pull-req-merge-commit.txt`ã‚’ä½œæˆã—ã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ (å…¨éƒ¨ä¸€åº¦ã«ã‚³ãƒ”ãƒšã§ãã¾ã™)
cat << EOF > pull-req-merge-commit.txt
a

b

c
EOF
git add --all
git commit -m "create pull-req-merge-commit.txt"
git push origin main
```

1 ã¤ã‚ã® Pull Request ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
git switch -c pr-merge-commit-1
sed -i 's/a/aaaaa/' pull-req-merge-commit.txt
git add --all
git commit -m "update a in pr-merge-commit-1"

# GitHubã«Pull Requestã‚’ä½œæˆ
git push --set-upstream origin pr-merge-commit-1
gh pr create --title pr-merge-commit-1 --body "" --base main --head pr-merge-commit-1
```

:::details Pull Request ã® File diff
![branch-merge-commit-1](/images/f20aee8979292d/branch-merge-commit-1.png)
:::

æ¬¡ã« 1 ã¤ã‚ã® Pull Request ã¨[ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆ](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/addressing-merge-conflicts/about-merge-conflicts)ã‚’èµ·ã“ã•ãªã„ã‚ˆã†ã« 2 ã¤ã‚ã® Pull Request ã‚’ä½œæˆã—ã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
git switch -c pr-merge-commit-2 main
sed -i 's/b/bbbbb/' pull-req-merge-commit.txt
git add --all
git commit -m "update b in pr-merge-commit-2"
sed -i 's/c/ccccc/' pull-req-merge-commit.txt
git add --all
git commit -m "update c in pr-merge-commit-2"

# GitHubã«Pull Requestã‚’ä½œæˆ
git push --set-upstream origin pr-merge-commit-2
gh pr create --title pr-merge-commit-2 --body "" --base main --head pr-merge-commit-2
```

:::details Pull Request ã® File diff
![branch-merge-commit-2](/images/f20aee8979292d/branch-merge-commit-2.png)
:::

ã“ã‚Œã§ merge commit ã®å‹•ä½œã‚’ç¢ºèªã™ã‚‹ãŸã‚ã® Pull Request ãŒ 2 ã¤ä½œæˆã•ã‚Œã¾ã—ãŸã€‚ã¾ãšã¯æœ€åˆã® Pull Request ã‚’ãƒãƒ¼ã‚¸ã—ã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
gh pr merge pr-merge-commit-1 --merge --delete-branch
```

:::details 1 ã¤ã‚ã® Pull Request ãƒãƒ¼ã‚¸çµæœ
ã“ã‚Œã«ã‚ˆã£ã¦ Merge commit ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

![github-log-merge-commit-1](/images/f20aee8979292d/github-log-merge-commit-1.png)

Merge commit ã® File diff ã¯ã€1 ã¤ç›®ã®ãƒ–ãƒ©ãƒ³ãƒã®ç›´å‰ã®ã‚³ãƒŸãƒƒãƒˆã® File diff ã¨åŒã˜å†…å®¹ã§ã™ã€‚

![git-pr-merge-5.png](/images/f20aee8979292d/git-pr-merge-5.png)

ç¶šã„ã¦ 2 ã¤ã‚ã® Pull Request ã‚’ãƒãƒ¼ã‚¸ã—ã¾ã™ã€‚

:::

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
gh pr merge pr-merge-commit-2 --merge --delete-branch
```

:::details 2 ã¤ã‚ã® Pull Request ãƒãƒ¼ã‚¸çµæœ
ã“ã‚Œã«ã‚ˆã£ã¦ Merge commit ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

![github-log-merge-commit-2](/images/f20aee8979292d/github-log-merge-commit-2.png)

Merge commit ã® File diff ã¯ã€2 ã¤ç›®ã®ãƒ–ãƒ©ãƒ³ãƒã®å…¨ã¦ã®ã‚³ãƒŸãƒƒãƒˆã® File diff ã‚’åˆã‚ã›ãŸå†…å®¹ã§ã™ã€‚

![git-pr-merge-6.png](/images/f20aee8979292d/git-pr-merge-6.png)
:::

GitHub å´ã§æ›´æ–°ã•ã‚ŒãŸ main ãƒ–ãƒ©ãƒ³ãƒã‚’ pull ã—ã¾ã—ã‚‡ã†ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
git switch main
git pull origin main
```

:::details git log ã®ç¢ºèª

GitHub ä¸Šã§ã“ã“ã¾ã§ã® git log ã‚’ç¢ºèªã™ã‚‹ã¨ã€ä¸€ç›´ç·šã«ã‚³ãƒŸãƒƒãƒˆãŒä¸¦ã‚“ã§ã„ã¦ã€ã‹ã¤ Merge commit2 ã¤ãŒé€£ç¶šã—ã¦ã„ã‚‹ã‚ˆã†ã«ã¿ãˆã¦ã—ã¾ã„ã¾ã™ã€‚

![github-log-merge-commit](/images/f20aee8979292d/github-log-merge-commit.png)

Merge commit ã«ã‚ˆã£ã¦åˆ†å²ãŒç™ºç”Ÿã—ãŸå ´åˆã«ã¯ã€ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèªã™ã‚‹ã¨åˆ†å²ã®æ§˜å­ãŒã‚ã‹ã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
git log --oneline --decorate --graph
```

```txt:å®Ÿè¡Œçµæœ
*   012ef98 Merge pull request #2 from richardimaoka/pr-merge-commit-2
|\
| * 30d1b5b update 3 in pr-merge-commit-2
| * 474cc81 update 2 in pr-merge-commit-2
* |   4f7c52c Merge pull request #1 from richardimaoka/pr-merge-commit-1
|\ \
| |/
|/|
| * 93924f6 update 1 in pr-merge-commit-1
|/
* 5ae629f create pull-req-merge-commit.txt
```

:::

## fast-forward merge locally

:::details (create a merge commit ã§ã¯) ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ --no-ff ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ¼ã‚¸ã•ã‚Œã¾ã™ãŒâ€¦

### fast-forward merge locally

```shell
touch local-ff.txt
git add --all
git commit -m "create local-ff.txt"

git switch -c local-ff-1
echo a > local-ff.txt
git add --all
git commit -m "add a in branch local-ff-1"
echo b >> local-ff.txt
git add --all
git commit -m "add b in branch local-ff-1"
```

![altãƒ†ã‚­ã‚¹ãƒˆ](/images/f20aee8979292d/git-pr-merge-1.png)

```shell
git switch main
git merge local-ff-1
git branch -d local-ff-1

git push origin main
```

![altãƒ†ã‚­ã‚¹ãƒˆ](/images/f20aee8979292d/git-pr-merge-2.png)

### no-ff merge locally

```shell
touch local-no-ff.txt
git add --all
git commit -m "create local-no-ff.txt"

git switch -c local-no-ff-1
echo a > local-no-ff.txt
git add --all
git commit -m "add a in branch local-no-ff-1"
echo b >> local-no-ff.txt
git add --all
git commit -m "add b in branch local-no-ff-1"

git switch main
git merge --no-ff --no-edit local-no-ff-1
git branch -d local-no-ff-1

git push origin main
```

![altãƒ†ã‚­ã‚¹ãƒˆ](/images/f20aee8979292d/git-pr-merge-3.png)

:::

## Squash and merge

```shell
cat << EOF > pull-req-squash-merge.txt
a

b

c
EOF
git add --all
git commit -m "create pull-req-squash-merge.txt"
git push origin main

git switch -c pr-squash-merge-1
sed -i 's/a/aaaaa/' pull-req-squash-merge.txt
git add --all
git commit -m "update a in pr-squash-merge-1"
git push --set-upstream origin pr-squash-merge-1

git switch -c pr-squash-merge-2 main
sed -i 's/b/bbbbb/' pull-req-squash-merge.txt
git add --all
git commit -m "update b in pr-squash-merge-2"
sed -i 's/c/ccccc/' pull-req-squash-merge.txt
git add --all
git commit -m "update c in pr-squash-merge-2"
git push --set-upstream origin pr-squash-merge-2

gh pr create --title pr-squash-merge-1 --body "" --base main --head pr-squash-merge-1
gh pr create --title pr-squash-merge-2 --body "" --base main --head pr-squash-merge-2
gh pr merge pr-squash-merge-1 --squash --delete-branch # PRã®Squash merge
gh pr merge pr-squash-merge-2 --squash --delete-branch # PRã®Squash merge

git switch main
git pull origin main
```

![altãƒ†ã‚­ã‚¹ãƒˆ](/images/f20aee8979292d/git-pr-merge-7.png)

![altãƒ†ã‚­ã‚¹ãƒˆ](/images/f20aee8979292d/git-pr-merge-8.png)

```shell
git log --oneline --decorate --graph
```

## Rebase and merge

```shell
cat << EOF > pull-req-rebase-merge.txt
a

b

c
EOF
git add --all
git commit -m "create pull-req-rebase-merge.txt"
git push origin main

git switch -c pr-rebase-merge-1
sed -i 's/a/aaaaa/' pull-req-rebase-merge.txt
git add --all
git commit -m "update a in pr-rebase-merge-1"
git push --set-upstream origin pr-rebase-merge-1

git switch -c pr-rebase-merge-2 main
sed -i 's/b/bbbbb/' pull-req-rebase-merge.txt
git add --all
git commit -m "update b in pr-rebase-merge-2"
sed -i 's/c/ccccc/' pull-req-rebase-merge.txt
git add --all
git commit -m "update c in pr-rebase-merge-2"
git push --set-upstream origin pr-rebase-merge-2

gh pr create --title pr-rebase-merge-1 --body "" --base main --head pr-rebase-merge-1
gh pr create --title pr-rebase-merge-2 --body "" --base main --head pr-rebase-merge-2
gh pr merge pr-rebase-merge-1 --rebase --delete-branch
gh pr merge pr-rebase-merge-2 --rebase --delete-branch

git switch main
git pull origin main
git branch -D pr-rebase-merge-1
git branch -D pr-rebase-merge-2

git log --oneline --decorate --graph
```
