---
title: "ã‚³ãƒ”ãƒšã§å­¦ã¶ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«: Dockerfileã®CMDã¨ENTRYPOINTã®é•ã„"
emoji: "ğŸ·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["docker"]
published: false
---

Dockerfile ã® CMD ã¨ ENTRYPOINT ã«ã¤ã„ã¦ã€æ‰‹ã‚’å‹•ã‹ã—ã¦å‹•ä½œç¢ºèªã§ãã‚‹ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚‚ã‚ã‚‹ã¨ç†è§£ãŒã—ã‚„ã™ã„ã‹ã¨æ€ã„ã€ã‚³ãƒ”ãƒšã ã‘ã§ç°¡å˜ã«å­¦ã¹ã‚‹ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

:::details ãã‚Œãã‚Œã®é•ã„ã«ã¤ã„ã¦ã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã‚‚ã€æ•°å¤šãã®ãƒ–ãƒ­ã‚°è¨˜äº‹ãªã©ã§ã‚‚è§£èª¬ã•ã‚Œã¦ã„ã¾ã™ã€‚

- [Dockerfile reference](https://docs.docker.com/engine/reference/builder/#cmd)
- [Best practices for writing Dockerfiles](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#cmd)
- POCKETSTUDIO.NET (å‰ä½› é›…äººã•ã‚“ã®ãƒ–ãƒ­ã‚°) - [ENTRYPOINT ã¯ã€Œå¿…ãšå®Ÿè¡Œã€ã€CMD ã¯ã€Œï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ï¼‰å¼•æ•°ã€](https://pocketstudio.net/2020/01/31/cmd-and-entrypoint/)

:::

## äº‹å‰æº–å‚™

ã¾ãšã¯ä»Šå›ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§åˆ©ç”¨ã™ã‚‹ Dockerfile ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹ GitHub ãƒ¬ãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¾ã™ã€‚

```sh
git clone git@github.com:richardimaoka/tutorial-docker-cmd-entrypoint.git
cd tutorial-docker-cmd-entrypoin
```

## CMD ã®å‹•ä½œç†è§£

ã¾ãšã¯ CMD ã ã‘ã‚’å…ˆã«ç†è§£ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã€ã„ã£ãŸã‚“ ENTRYPOINT ã®ã“ã¨ã‚’å¿˜ã‚Œã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã¯ä¸¡è€…ãŒã¨ã¦ã‚‚ä¼¼ã¦ã„ã¦ã€åŒæ™‚ã«ç†è§£ã—ã‚ˆã†ã¨ã™ã‚‹ã¨æ··ä¹±ã™ã‚‹ã‹ã‚‰ã§ã™ã€‚

```dockerfile:Dockerfile.cmd1
FROM ubuntu
CMD ["echo", "abc"]
```

ä¸Šè¨˜ã® Dockerfile ã‚’ build ã—ã¦ run ã—ã¾ã—ã‚‡ã†ã€‚å†’é ­ã§ã‚¯ãƒ­ãƒ¼ãƒ³ã—ãŸ GitHub ãƒ¬ãƒã‚¸ãƒˆãƒªã« Dockerfile.cmd1 ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã®ã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```sh
docker build -t cmd1 -f Dockerfile.cmd1 .
docker run cmd1
```

```sh:docker runã®çµæœ
abc
```

```dockerfile:Dockerfile.cmd2
FROM ubuntu
CMD ["echo", "abc", "def"]
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```sh
docker build -t cmd2 -f Dockerfile.cmd2 .
docker run cmd2
```

```dockerfile:Dockerfile.cmd3
FROM ubuntu
CMD echo "abc"
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```sh
docker build -t cmd3 -f Dockerfile.cmd3 .
docker run cmd3
```

```dockerfile:Dockerfile.cmd4
FROM ubuntu
CMD echo "abc" "def"
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```sh
docker build -t cmd4 -f Dockerfile.cmd4 .
docker run cmd4
```

```dockerfile:Dockerfile.cmd5
FROM ubuntu
CMD echo "$HOME"
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```sh
docker build -t cmd5 -f Dockerfile.cmd5 .
docker run cmd5
```

```dockerfile:Dockerfile.cmd6
FROM ubuntu
CMD [ "sh", "-c", "echo $HOME" ]
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```sh
docker build -t cmd6 -f Dockerfile.cmd6 .
docker run cmd6
```

```sh
# SIGTERM not received with shell form
docker run nginx:1.21
```

ä»¥ä¸‹ã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```sh
# Ctrl + c
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

````sh
docker build - t nginx: cmd-shellform - f Dockerfile.cmd-nginx .
docker run - -name cnt-nginx-shellform nginx: cmd-shellform
# Ctrl + c, not working!!
```

```sh:another terminal
docker stop cnt-nginx-shellform

```dockerfile:Dockerfile.cmd7
FROM ubuntu
CMD ["tail", "-f", "/dev/null"]
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```sh
docker build -t cmd7 -f Dockerfile.cmd7 .
docker run cmd7
```

```dockerfile:Dockerfile.cmd8
FROM ubuntu
CMD tail -f /dev/null
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```sh
docker build -t cmd8 -f Dockerfile.cmd8 .
docker run cmd8
```

```dockerfile:Dockerfile.cmd9
FROM ubuntu
CMD ["echo", "abc"]
CMD ["echo", "def"]
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```sh
docker build -t cmd9 -f Dockerfile.cmd9 .
docker run cmd9
```

````
