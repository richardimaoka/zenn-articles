---
title: "ã‚³ãƒ”ãƒšã§å­¦ã¶ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«: GitHub Pull Request ã® merge conflict è§£æ±ºæ‰‹æ³•ã‚’è©¦ã™"
emoji: "ğŸ·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["git"]
published: false
---

## å°å…¥

GitHub ã® pull request ã§ [merge conflict ãŒç™ºç”Ÿã—ãŸéš›](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/addressing-merge-conflicts/about-merge-conflicts)ã€ãã®è§£æ±ºã«ã¯ 1.GitHub ã® Web UI ä¸Šã§è¡Œã†ã‚‚ã®ã¨ã€2.ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã§è¡Œã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚

1. [GitHub å…¬å¼: GitHub ã§ã®ãƒãƒ¼ã‚¸ ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’è§£æ±ºã™ã‚‹](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/addressing-merge-conflicts/resolving-a-merge-conflict-on-github)
2. [GitHub å…¬å¼: ã‚³ãƒãƒ³ãƒ‰ ãƒ©ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ¼ã‚¸ ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’è§£æ±ºã™ã‚‹](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/addressing-merge-conflicts/resolving-a-merge-conflict-using-the-command-line)

è§£æ±ºæ‰‹æ³•ã®é•ã„ã«ã¤ã„ã¦æ‰‹ã‚’å‹•ã‹ã—ã¦å‹•ä½œç¢ºèªã™ã‚‹ã¨ã€çŸ¥è­˜ã®æ•´ç†ã‚‚ã§ãã‚‹ã¨æ€ã„ã¾ã™ã®ã§ã€æœ¬è¨˜äº‹ã§ã¯ã‚³ãƒ”ãƒšã§è²¼ã‚Šä»˜ã‘ã‚‹ã ã‘ã§ç°¡å˜ã«æ‰‹é †ã‚’å†ç¾ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

:::details merge conflict ãŒãªã„å ´åˆã® update æ‰‹æ³•ã¨ã®åŒºåˆ¥

æœ¬è¨˜äº‹ã§å¯¾è±¡ã¨ã™ã‚‹ã®ã¯ pull request ã§ merge conflict ã‚’è§£æ±ºã™ã‚‹æ‰‹æ³•ãªã®ã§ã€merge conflict ãŒç™ºç”Ÿã—ã¦ã„ãªã„ã¨ãã« pull request update ã™ã‚‹æ‰‹æ³•ã¨ã¯åŒºåˆ¥ã—ã¦ãã ã•ã„ã€‚å¾Œè€…ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

- [GitHub å…¬å¼: ãƒ™ãƒ¼ã‚¹ ãƒ–ãƒ©ãƒ³ãƒã¨ pull request ã®åŒæœŸã®ç¶­æŒ](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/keeping-your-pull-request-in-sync-with-the-base-branch)
- [GitHub å…¬å¼ blog: More ways to keep your pull request branch up-to-date](https://github.blog/changelog/2022-02-03-more-ways-to-keep-your-pull-request-branch-up-to-date/)
- [ã‚³ãƒ”ãƒšã§å­¦ã¶ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«: GitHub Pull Request ã® update æ‰‹æ³•ã‚’è©¦ã™](./6c36be1256c4fa)

:::

:::details pull request ã®ãƒãƒ¼ã‚¸æ‰‹æ³•ã¨ã®åŒºåˆ¥

æœ¬è¨˜äº‹ã§å¯¾è±¡ã¨ã™ã‚‹ã®ã¯ pull requestã€å†…ã€ã§ merge conflict ã‚’è§£æ±ºã™ã‚‹æ‰‹æ³•ãªã®ã§ã€pull request è‡ªä½“ã‚’ base ãƒ–ãƒ©ãƒ³ãƒã¸ã¨ merge ã™ã‚‹æ‰‹æ³•ã¨ã¯åŒºåˆ¥ã—ã¦ãã ã•ã„ã€‚å¾Œè€…ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

- [GitHub å…¬å¼: ã‚³ãƒãƒ³ãƒ‰ ãƒ©ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ¼ã‚¸ ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’è§£æ±ºã™ã‚‹](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/incorporating-changes-from-a-pull-request/about-pull-request-merges)
- [ã‚³ãƒ”ãƒšã§å­¦ã¶ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«: GitHub Pull Request 3 ç¨®é¡ã® merge æ‰‹æ³•ã‚’è©¦ã™](./f20aee8979292d)

:::

## æº–å‚™: GitHub ãƒ¬ãƒã‚¸ãƒˆãƒªã®ä½œæˆ

ã¾ãšã¯ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ git ãƒ¬ãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
mkdir pull-req-conflict-experiments
cd pull-req-conflict-experiments
git init
```

GitHub ä¸Šã«ãƒ¬ãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚Web ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ãªãã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ãˆã°ä¸€ç™ºã§çµ‚ã‚ã‚Šã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
gh repo create pull-req-conflict-experiments --public --source=. --remote=origin
```

:::details ã€€ä¸Šè¨˜ã® gh ã‚³ãƒãƒ³ãƒ‰ã¯ä½•ï¼Ÿ
[gh ã‚³ãƒãƒ³ãƒ‰(GitHub CLI)](https://cli.github.com/)ã‚’ä½¿ãˆã°ã€GitHub ä¸Šã§ã®ãƒªãƒã‚¸ãƒˆãƒªä½œæˆãªã©ä½œæ¥­ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰ã‚³ãƒãƒ³ãƒ‰ã²ã¨ã¤ã§è¡Œãˆã¾ã™ã€‚ã¾ã ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãªã„æ–¹ã¯ã€ãœã²ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚[gh repo create ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã®èª¬æ˜](https://cli.github.com/manual/gh_repo_create)ã«ã‚‚ã‚ã‚Šã¾ã™ãŒã€ä¸Šè¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨å¼•æ•°ã®æ„å‘³ã¯ã“ã¡ã‚‰ã§ã™ã€‚

- `pull-req-udpate-experiments`: GitHub ä¸Šã®ãƒ¬ãƒã‚¸ãƒˆãƒªå
- `--public`: public ãƒ¬ãƒã‚¸ãƒˆãƒªã¨ã—ã¦ä½œæˆ
- `--source=.`: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¬ãƒã‚¸ãƒˆãƒªã®ãƒ‘ã‚¹ã¯ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª `.`
- `--remote=origin` ãƒªãƒ¢ãƒ¼ãƒˆãƒ¬ãƒã‚¸ãƒˆãƒªã‚’ origin ã«æŒ‡å®š

:::

## Merge conflict ãŒç™ºç”Ÿã—ãªã„å ´åˆ

æœ¬è¨˜äº‹ã¯ merge conflict è§£æ±ºæ‰‹æ³•ã®å‹•ä½œç¢ºèªãŒç›®çš„ã§ã™ãŒã€å¯¾æ¯”ã®ãŸã‚ã«ã¾ãšã¯ merge conflict ãŒç™ºç”Ÿã—ãªã„å ´åˆã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
cat << EOF > experiment1.txt
a

b

c
EOF
git add --all
git commit -m "create experiment1.txt"
git push origin main
```

ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã¯ã“ã¡ã‚‰ã§ã™ã€‚

```txt:experiment1.txt
a

b

c
```

æ¬¡ã«ã€pull request ã‚’ä½œæˆã—ã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
git switch -c pr-1

sed -i 's/a/aaaaa/' experiment1.txt # ãƒ•ã‚¡ã‚¤ãƒ«ä¸­ã®aã‚’aaaaaã«ç½®ãæ›ãˆ
git add --all
git commit -m "update a in pr-1"

git push --set-upstream origin pr-1
gh pr create --title pr-1 --body "" --base main --head pr-1
```

base ãƒ–ãƒ©ãƒ³ãƒã«ç›´æ¥å¤‰æ›´ã‚’åŠ ãˆã€push ã—ã¾ã—ã‚‡ã†ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
git switch main

# merge conflict ãŒç™ºç”Ÿã—ãªã„ã‚ˆã†ã€`pr-1`ã¨ã¯åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«è¡Œã‚’å¤‰æ›´ã—ã¦ã„ã¾ã™ã€‚
sed -i 's/b/bbbbb/' experiment1.txt # ãƒ•ã‚¡ã‚¤ãƒ«ä¸­ã®bã‚’bbbbbã«ç½®ãæ›ãˆ
git add --all
git commit -m "update b in main"

git push origin main
```

:::details base ãƒ–ãƒ©ãƒ³ãƒã® push ãŒ pull request ã® file diff ã«åæ˜ ã•ã‚Œãªã„ï¼Ÿ

base ãƒ–ãƒ©ãƒ³ãƒã®å¤‰æ›´ã‚’ push ã—ãŸã ã‘ã§ã¯ã€pull request ã® file diff ã¯æ›´æ–°ã•ã‚Œã¾ã›ã‚“ã€‚ä¸‹ç”»åƒã®ã‚ˆã†ã«ã€3 è¡Œç›®ãŒ`b`1 æ–‡å­—ã®ã¾ã¾ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

![pr-file-diff-1a](/images/6c36be1256c4fa/pr-file-diff-1a.png)

ã“ã‚Œã¯ã€GitHub ã§ã¯ pull request ã® file diff ã¯ base ãƒ–ãƒ©ãƒ³ãƒã®å¤‰æ›´ã‚’å–ã‚Šè¾¼ã¾ãªã„ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚base ãƒ–ãƒ©ãƒ³ãƒã®å¤‰æ›´ã‚’å–ã‚Šè¾¼ã‚€ã«ã¯ã€åˆ¥è¨˜äº‹ã€Œ[ã‚³ãƒ”ãƒšã§å­¦ã¶ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«: GitHub Pull Request ã® update æ‰‹æ³• 2 ç¨®é¡ã‚’è©¦ã™](./6c36be1256c4fa)ã€ã®è§£èª¬ã—ã¦ã„ã‚‹ update(rebase) branch ã®æ“ä½œãŒå¿…è¦ã§ã™ã€‚

:::

Pull request ã‚’è¦‹ã‚‹ã¨`This branch has no conflicts with the base branch`ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã®ã§ã€Merge pull request ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã—ã‚‡ã†ã€‚

![merge pull request button](/images/34aefc43a988ca/merge-pull-request-button.png)

:::details ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰ pull request ã‚’ãƒãƒ¼ã‚¸ã—ãŸã„å ´åˆ

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
gh pr merge pr-1 --merge --delete-branch
```

:::

## Merge conflict ã‚’ GitHub UI ä¸Šã§è§£æ±º (åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®åŒä¸€è¡Œã§ã® conflict)

å¤‰æ›´å¯¾è±¡ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« experiment2.txt ã‚’ä½œæˆã—ã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
cat << EOF > experiment2.txt
a

b

c
EOF
git add --all
git commit -m "create experiment2.txt"
git push origin main
```

ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã¯ã“ã¡ã‚‰ã§ã™ã€‚

```txt:experiment2.txt
a

b

c
```

Pull request ã‚’ä½œæˆã—ã¾ã™ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
git switch -c pr-2

sed -i 's/a/aaaaa/' experiment2.txt # ãƒ•ã‚¡ã‚¤ãƒ«ä¸­ã®aã‚’aaaaaã«ç½®ãæ›ãˆ
git add --all
git commit -m "update a in pr-2"

git push --set-upstream origin pr-2
gh pr create --title pr-2 --body "" --base main --head pr-2
```

base ãƒ–ãƒ©ãƒ³ãƒã«ç›´æ¥å¤‰æ›´ã‚’åŠ ãˆã€push ã—ã¾ã—ã‚‡ã†ã€‚

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
git switch main

# ã‚ã–ã¨merge conflict ãŒç™ºç”Ÿã™ã‚‹ã‚ˆã†ã€`pr-2`ã¨åŒä¸€ã®ãƒ•ã‚¡ã‚¤ãƒ«è¡Œã‚’å¤‰æ›´ã—ã¦ã„ã¾ã™
sed -i 's/a/aaa/' experiment2.txt # ãƒ•ã‚¡ã‚¤ãƒ«ä¸­ã®aã‚’aaaã«ç½®ãæ›ãˆ
git add --all
git commit -m "update b in main"

git push origin main
```

Pull request ã‚’è¦‹ã‚‹ã¨ merge conflict ãŒç™ºç”Ÿã—ã€Merge pull requst ãƒœã‚¿ãƒ³ã¯æŠ¼ã›ãªããªã£ã¦ã„ã¾ã™ã€‚ä»£ã‚ã‚Šã« Resolve conflicts ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã—ã‚‡ã†ã€‚

![merge conflict](/images/34aefc43a988ca/merge-conflict.png)

ã“ã®ã‚ˆã†ãªç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€merge conflict ã‚’è§£æ±ºã—ã¦ã„ãã¾ã™ã€‚

![resolve conflict 1](/images/34aefc43a988ca/resolve-conflict1.png)

`<<<<<<<` ã¨ `=======` ã¨ `>>>>>>>` ã‚’æ¶ˆã›ã°ã€å³ä¸Šã® Mark as resolved ãƒœã‚¿ãƒ³ãŒæŠ¼ã›ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

![resolve conflict 2](/images/34aefc43a988ca/resolve-conflict2.png)

ç¶šã„ã¦ã€Commit merge ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã—ã‚‡ã†ã€‚

![resolve conflict 3](/images/34aefc43a988ca/resolve-conflict3.png)

Resolve conflicts ãŒå®Œäº†ã™ã‚‹ã¨ã€`Merge branch 'main' into pr-2` ã¨ pull request ã® Commits ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚

![pr git log 1](/images/34aefc43a988ca/pr-git-log1.png)

Pull request ã‚’è¦‹ã‚‹ã¨`This branch has no conflicts with the base branch`ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã®ã§ã€Merge pull request ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã—ã‚‡ã†ã€‚

![merge pull request button](/images/34aefc43a988ca/merge-pull-request-button.png)

:::details ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰ pull request ã‚’ãƒãƒ¼ã‚¸ã—ãŸã„å ´åˆ

```sh:ã‚³ãƒ”ãƒšã—ã¦å®Ÿè¡Œ
gh pr merge pr-1 --merge --delete-branch
```

:::

![main git log](/images/34aefc43a988ca/main-git-log-1.png)

## åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–° vs. å‰Šé™¤ã® conflict

### åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®åŒä¸€è¡Œã§ã® conflict
